/*! jquery-simpletable - v0.0.1 - 2014-04-16
* https://github.com/edgardleal/jquery-simpletable
* Copyright (c) 2014 Edgard Leal; Licensed MIT */
var __x=eval;!function(a){a.widget("custom.simpleTable",{options:{keyField:null,data:void 0,url:void 0,editable:!1,columns:[],table:null,border:1},setStyle:function(){a(".jtable th").each(function(){a(this).addClass("ui-state-default")}),a(".jtable td").each(function(){a(this).addClass("ui-widget-content")})},_setupHead:function(){var b=this,c='<thead><tr class="ui-widget-header">';for(var d in b.options.columns)c+='<th clas="ui-state-default" width="'+b.options.columns[d].width+'">'+b.options.columns[d].title+"</th>";b.element.prepend(a(c+"</tr>"))},_setupBody:function(){var a="<tbody></tbody>";return this.body=this.element.append(a),this.bory},_findColumn:function(a){for(var b in this.options.columns)if(this.options.columns[b].title===a)return this.options.columns[b]},save:function(b){var c=this;c.options.url&&a.post({url:c.options.url,data:c._serializeRow(b)})},_createRow:function(b,c){for(var d=this,e='<tr id="'+c+'">',f=d.options.editable?'contenteditable="true"':"",g=1;b>=g;g++)e+="<td "+f+' class="ui-widget-content"></td>';var h=a(e+"</tr>");return d.body.append(h),h.hover(function(){a(this).children("td").addClass("ui-state-hover")},function(){a(this).children("td").removeClass("ui-state-hover")}).click(function(){a(this).children("td").toggleClass("ui-state-highlight")}),d.options.autosave&&h.find("td").change(function(){h.modified=!0,d.options.autosave&&d.save(h)}),h},checkCondition:function(a,b){var c='var value="'+a+'"\n';c+=b;try{return __x(c)}catch(d){}},_buildCellHtml:function(a,b,c,d){var e=a[b.field];return b.mapFunction&&"function"==typeof b.mapFunction&&(e=b.mapFunction.call(this,a,b,c,d)),e},_refreshRow:function(a){var b=this,c=a[b.options.keyField];if(!c)throw"keyField not pased";var d=b.body.find("tr[id="+c+"]");(!d||d.length<1)&&(d=b._createRow(b.options.columns.length,c));var e=0,f=d.find("td");for(var g in b.options.columns){var h=b.options.columns[g];if(h){var i=a[h.field],j='var value="'+i+'"\n',k=f.get(e++);if(h.conditions)for(var l in h.conditions)try{if(__x(j+h.conditions[l].expression)){var m=h.conditions[l].cell,n=h.conditions[l].parent;m&&(k.style.cssText=m),n&&(d.get(0).style.cssText=n);break}}catch(o){}k.innerHTML=b._buildCellHtml(a,h,d,k)}}},refresh:function(){var a=this;for(var b in a.options.data)a._refreshRow(a.options.data[b])},_create:function(){var a=this;a.head=a.element.find("thead"),a.head.length||a._setupHead(),a.body=a.element.find("tbody"),a.body.length||a._setupBody();for(var b in a.options.columns)a.options.columns[b].field||(a.options.columns[b].field=a.options.columns[b].title);a.element.addClass("ui-widget").attr("border",a.options.border),this.refresh()}}),a.expr[":"].simpletable=function(b){return a(b).hasClass("simpletable")}}(jQuery);